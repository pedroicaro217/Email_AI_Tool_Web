{% extends 'base.html' %}

{% block title %}HistÃ³rico de Campanhas - {{ super() }}{% endblock %}

{% block content %}
    <h1>ðŸ“‹ HistÃ³rico de Campanhas</h1>
    <p>Veja o status de todas as campanhas, passadas e presentes. Clique em uma campanha para ver o status de cada destinatÃ¡rio.</p>

    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Assunto</th>
                <th>Autor</th>
                <th>Status</th>
                <th>Criada em</th>
                <th>AÃ§Ãµes</th>
            </tr>
        </thead>
        <tbody>
            {% for campaign in campaigns %}
            <tr>
                <td>{{ campaign.id }}</td>
                <td>{{ campaign.subject }}</td>
                
                <td>
                    {% if campaign.user %}
                        {{ campaign.user.username }}
                    {% else %}
                        <span style="color: #ccc;">-</span>
                    {% endif %}
                </td>

                <td>
                    <strong>{{ campaign.status }}</strong>
                    
                    {% if campaign.status == 'Agendado' and campaign.scheduled_at %}
                        <br>
                        <small style="color: #007bff; font-weight: bold;">
                            ðŸ•’ {{ campaign.scheduled_at | datetimeformat }}
                        </small>
                    {% endif %}
                </td>

                <td>
                    {{ campaign.created_at | datetimeformat }}
                </td>
                <td>
                    <a href="{{ url_for('main.campaign_detail', campaign_id=campaign.id) }}" class="btn btn-secondary">Ver Detalhes</a>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="6">Nenhuma campanha encontrada. Crie uma!</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}